<style>
    /* Define some colors */
    :root {
        --primary-color: #007BFF;
        --light-gray: #f4f4f4;
        --medium-gray: #ddd;
        --dark-gray: #333;
        --correct-green: #28a745;
        --incorrect-red: #dc3545;
        --white: #ffffff;
    }

    /* Basic page setup */
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background-color: var(--light-gray);
        color: var(--dark-gray);
        line-height: 1.6;
    }

    /* Container for both pages */
    .qcm-container,
    .qcm-result-container {
        max-width: 800px;
        margin: 2rem auto;
        padding: 2rem;
        background-color: var(--white);
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    /* --- Title --- */
    .qcm-title {
        white-space: pre-wrap; /* You had this, it's good! */
        font-weight: 700;
        font-size: 2rem;
        text-align: center;
        margin-bottom: 2rem;
        color: var(--primary-color);
    }

    /* --- Question Block --- */
    .question-block {
        margin-bottom: 1.5rem;
        padding: 1.5rem;
        border: 1px solid var(--medium-gray);
        border-radius: 8px;
        background: #fdfdfd;
    }

    /* --- Question Text (Both Pages) --- */
    .question-text {
        white-space: pre-wrap;   /* Good, keep this */
        font-weight: 600;      /* Bolder */
        font-size: 1.2rem;       /* Bigger */
        line-height: 1.5;
        margin-bottom: 1rem;
    }
    
    /* === QCM Detail (Form) Styles === */

    .choice {
        margin-bottom: 0.75rem;
    }

    .choice label {
        display: block;
        padding: 0.75rem 1rem;
        border: 1px solid var(--medium-gray);
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s, border-color 0.2s;
    }

    .choice label:hover {
        background-color: #f9f9f9;
        border-color: #bbb;
    }
    
    /* Style the input (radio/checkbox) itself */
    .choice input[type="radio"],
    .choice input[type="checkbox"] {
        margin-right: 0.75rem;
        /* Make the default inputs a bit bigger */
        transform: scale(1.2);
    }

    /* --- Button (Submit & Try Again) --- */
    .btn-submit,
    .btn-try-again {
        display: inline-block;
        width: 100%;
        text-align: center;
        padding: 0.75rem 1.5rem;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--white);
        background-color: var(--primary-color);
        border: none;
        border-radius: 5px;
        text-decoration: none;
        cursor: pointer;
        transition: background-color 0.2s, box-shadow 0.2s;
    }

    .btn-submit:hover,
    .btn-try-again:hover {
        background-color: #0056b3;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }


    /* === QCM Result Styles === */

    /* --- Score Display --- */
    .score-display {
        font-size: 1.75rem;
        font-weight: 700;
        text-align: center;
        margin-bottom: 2rem;
        padding: 1rem;
        background-color: var(--light-gray);
        border-radius: 5px;
    }

    .score-display strong {
        color: var(--primary-color);
        font-size: 2rem;
    }

    /* --- Result List --- */
    .result-choices {
        list-style-type: none;
        padding-left: 0;
    }
    .result-choices li {
        padding: 0.5rem;
        border: 1px solid #eee;
        border-radius: 4px;
        margin-bottom: 0.5rem;
    }

    /* --- Feedback text (Correct/Incorrect) --- */
    .result-status {
        font-size: 1.2rem;
        font-weight: 700;
        text-transform: uppercase;
        margin-top: 1rem;
        padding: 0.5rem;
        border-radius: 4px;
        text-align: center;
    }
    .result-status.correct {
        color: var(--correct-green);
        background-color: #eaf6ec;
    }
    .result-status.incorrect {
        color: var(--incorrect-red);
        background-color: #fbebee;
    }
    
    /* --- Highlighting answers in results --- */
    .feedback-correct {
        font-weight: 700;
        color: var(--correct-green);
    }
    .feedback-selected {
        font-style: italic;
        color: #555;
        margin-left: 0.5rem;
        /* Add a checkmark or X for visual cue */
    }
    .feedback-selected.wrong {
        color: var(--incorrect-red);
    }
    .feedback-selected.right {
        color: var(--correct-green);
    }
    
</style>

<div class="qcm-result-container">
    <h1 class="qcm-title">{{ qcm.title }} — Results</h1>

    {% comment %} 
    Wrapped score in a styled div 
    {% endcomment %}
    <div class="score-display">
        Your score: <strong>{{ score }}</strong> / {{ total }}
    </div>

    {% for d in details %}
    <div class="question-block">
        <h3 class="question-text">Question {{ forloop.counter }}: {{ d.question.text }}</h3>

        {% comment %} 
        Added a class to the list for styling 
        {% endcomment %}
        <ul class="result-choices">
            {% for choice in d.choices %}
            <li>
                {% if choice.id in d.correct_ids %}
                    {% comment %} Added class for "correct answer" text {% endcomment %}
                    <strong class="feedback-correct">{{ choice.text }} — Correct Answer</strong>
                {% else %}
                    {{ choice.text }}
                {% endif %}

                {% if choice.id in d.selected_ids %}
                    {% comment %} 
                    Added classes for "user selected" text, with logic 
                    to show if that selection was right or wrong.
                    {% endcomment %}
                    {% if choice.id in d.correct_ids %}
                        <em class="feedback-selected right">(You selected this)</em>
                    {% else %}
                        <em class="feedback-selected wrong">(You selected this)</em>
                    {% endif %}
                {% endif %}
            </li>
            {% endfor %}
        </ul>

        {% comment %} 
        Replaced inline style with classes 
        {% endcomment %}
        {% if d.is_correct %}
        <p class="result-status correct"><strong>Correct</strong></p>
        {% else %}
        <p class="result-status incorrect"><strong>Incorrect</strong></p>
        {% endif %}
    </div>
    {% endfor %}

    {% comment %} 
    Applied the new button style to the link 
    {% endcomment %}
    <a href="{% url 'qcm_detail' qcm.id %}" class="btn-try-again">
        Try Again
    </a>
</div>